(this["webpackJsonpbook-site-front"]=this["webpackJsonpbook-site-front"]||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(24),i=n.n(s),c=(n(30),n(9)),o=n(5),l=n(6),d=n(8),u=n(7),h=n(3),j=n(10),b=(n(31),n(0));var m=Object(j.f)((function(){return null!==localStorage.getItem("token")?Object(b.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-danger",children:Object(b.jsxs)("div",{className:"container-fluid",children:[Object(b.jsx)(h.b,{className:"navbar-brand",to:"/",children:"BookSide"}),Object(b.jsx)("div",{children:Object(b.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/",children:"Search"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/users/".concat(localStorage.getItem("currentUser")),children:"Profile"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/settings",children:"Settings"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/login",onClick:function(){localStorage.clear()},children:"Logout"})})]})})]})}):Object(b.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-danger",children:Object(b.jsxs)("div",{className:"container-fluid",children:[Object(b.jsx)(h.b,{className:"navbar-brand",to:"/",children:"BookSide"}),Object(b.jsx)("div",{children:Object(b.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/",children:"Search"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/login",children:"Login"})})]})})]})})})),v=n(2),f="https://www.googleapis.com/books",O=function(e){return fetch(f+"/v1/volumes/"+e).then((function(e){return e.json()}))},g=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).getBooks=function(){var e;(e=a.state.searchTitle,fetch(f+"/v1/volumes?q=search+"+e).then((function(e){return e.json()}))).then((function(e){a.setState({books:e.items,loading:!1})}))},a.showThumbnail=function(e){return void 0!==e.volumeInfo.imageLinks?Object(b.jsx)("img",{className:"mt-3",src:e.volumeInfo.imageLinks.thumbnail,alt:e.volumeInfo.title}):Object(b.jsx)("p",{className:"mt-3",children:"(No image available)"})},a.componentDidMount=function(){a.getBooks()},a.state={books:[],searchTitle:e.sTitle,loading:!0},a.getBooks=a.getBooks.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.books?Object(b.jsx)("div",{className:"row row-cols-3",children:this.state.books.map((function(t){return Object(b.jsx)("div",{className:"col col-sm-4 border border-white",children:Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/book/".concat(t.id),children:Object(b.jsxs)("div",{children:[e.showThumbnail(t),Object(b.jsx)("p",{children:t.volumeInfo.title})]})},t.id)},t.id)}))}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"No search results"})})}}]),n}(r.a.Component),x=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).setSubject=function(e,t){e=Math.ceil(e),t=Math.floor(t);var n=Math.floor(Math.random()*(t-e+1))+e;switch(console.log(n),n){case 1:return"fiction";case 2:return"science";case 3:return"horror";case 4:return"comics";case 5:return"fantasy";case 6:return"ya";case 7:return"diy";default:return"fiction"}},a.getBooks=function(){var e;(e=a.state.subject,fetch(f+"/v1/volumes?q=subject:"+e).then((function(e){return e.json()}))).then((function(e){a.setState({books:e.items,loading:!1})}))},a.showThumbnail=function(e){return void 0!==e.volumeInfo.imageLinks?Object(b.jsx)("img",{className:"mt-3",src:e.volumeInfo.imageLinks.thumbnail,alt:e.volumeInfo.title}):Object(b.jsx)("p",{className:"mt-3",children:"(No image available)"})},a.componentDidMount=function(){a.getBooks()},a.state={books:[],subject:a.setSubject(1,7),loading:!0},a.getBooks=a.getBooks.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.books?Object(b.jsx)("div",{className:"row row-cols-3",children:this.state.books.map((function(t){return Object(b.jsx)("div",{className:"col col-sm-4 border border-white",children:Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/book/".concat(t.id),children:Object(b.jsxs)("div",{children:[e.showThumbnail(t),Object(b.jsx)("p",{children:t.volumeInfo.title})]})},t.id)},t.id)}))}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading"})})}}]),n}(r.a.Component),p=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).toggler=function(){a.setState((function(e){return{toggle:!e.toggle}}))},a.searchResults=function(){return a.state.toggle?Object(b.jsx)("div",{children:Object(b.jsx)(g,{sTitle:a.state.searchTitle})}):Object(b.jsx)(x,{})},a.handleTitleSearch=function(e){e.preventDefault(),a.setState((function(e){return{byAuthor:!1}})),a.toggler()},a.handleChange=function(e){e.preventDefault();var t=e.target.value;a.setState((function(){return{toggle:!1,searchTitle:t}}))},a.state={searchTitle:"",byAuthor:!1,toggle:!1},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleTitleSearch=a.handleTitleSearch.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"container",children:[Object(b.jsx)("div",{className:"d-inline-flex",children:Object(b.jsx)("form",{onSubmit:this.handleTitleSearch,children:Object(b.jsxs)("div",{className:"row g-3 align-items-center mt-1",children:[Object(b.jsx)("div",{className:"col-auto",children:Object(b.jsx)("label",{for:"searchTitle",className:"col-form-label",children:"Search for books"})}),Object(b.jsx)("div",{className:"col-auto",children:Object(b.jsx)("input",{className:"form-control",type:"search",placeholder:"Search",name:"searchTitle",value:this.state.searchTitle,onChange:this.handleChange})}),Object(b.jsx)("div",{className:"col-auto",children:Object(b.jsx)("button",{className:"btn btn-outline-danger",type:"submit",children:"Search"})})]})})}),Object(b.jsx)("div",{className:"mt-3",children:this.searchResults()})]})}}]),n}(r.a.Component);var w=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)("div",{children:Object(b.jsx)(p,{})})})},k=n(15),N=n(4),C=n.n(N),y=n(12),S=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",authorization:"bearer "+localStorage.getItem("token")},body:JSON.stringify(t)},e.prev=1,e.next=4,fetch("https://booksight.jelastic.metropolia.fi/graphql",n);case 4:return a=e.sent,e.next=7,a.json();case 7:return r=e.sent,e.abrupt("return",r.data);case 11:return e.prev=11,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            {\n                login(\n                username: "'.concat(t.username,'",\n                password: "').concat(t.password,'"\n                ) {\n                id,\n                username,\n                token\n                }\n            }')},e.next=3,S(n);case 3:return a=e.sent,e.abrupt("return",a.login);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).doLogin=function(){var e={username:a.state.user.username,password:a.state.user.password};I(e).then((function(e){if(null!==e){if(void 0!==e.username){var t=a.props.setUser(e);return localStorage.setItem("token",e.token),localStorage.setItem("currentUser",e.id),a.props.history.push("/"),t}a.setState({errorMessage:"Username or password is incorrect."})}else a.setState({errorMessage:"Something went wrong"})}))},a.state={user:{username:"",password:""},errorMessage:"",validUser:!0},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(a)),a.doLogin=a.doLogin.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.value,a=t.name;this.setState((function(e){return{user:Object(c.a)(Object(c.a)({},e.user),{},Object(k.a)({},a,n))}}))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.doLogin()}},{key:"render",value:function(){return Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:"d-inline-flex",children:Object(b.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(b.jsx)("h1",{children:"Login"}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"username",className:"form-label",children:"Username"}),Object(b.jsx)("input",{type:"text",className:"form-control height=200px",name:"username",id:"username",label:"Username",value:this.state.user.username,onChange:this.handleChange})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"password",children:"Password"}),Object(b.jsx)("input",{type:"password",className:"form-control",name:"password",id:"password",label:"Password",value:this.state.user.password,onChange:this.handleChange})]}),Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:this.state.errorMessage})}),Object(b.jsxs)("div",{children:[Object(b.jsxs)("p",{children:["Don't have an account yet? ",Object(b.jsx)(h.b,{to:"/signup",children:"Sign up here!"})]}),Object(b.jsx)("p",{children:"\n"})]}),Object(b.jsx)("button",{type:"submit",className:"btn btn-danger",children:"Login"})]})})})}}]),n}(r.a.Component),D=Object(j.f)(B);var U=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(D,{setUser:e.setUser})})},R=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n             {\n                user(id: "'.concat(t,'"){\n                    id, \n                    username,\n                    email,\n                    description\n                }\n            }')},e.next=3,S(n);case 3:return a=e.sent,e.abrupt("return",a.user);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            mutation {\n                signup(\n                username: "'.concat(t.username,'", \n                password: "').concat(t.password,'", \n                email: "').concat(t.email,'",\n                description: "').concat(t.description,'",\n                ){\n                id, \n                username\n                }\n            }')},e.next=3,S(n);case 3:return a=e.sent,e.abrupt("return",a.signup);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(y.a)(C.a.mark((function e(t,n){var a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={query:'\n            mutation {\n                modifyUser(\n                id: "'.concat(n,'",\n                username: "').concat(t.username,'",\n                email: "').concat(t.email,'",\n                description: "').concat(t.description,'",\n                ) {\n                id, \n                username,\n                description\n                }\n            }')},e.next=3,S(a);case 3:return r=e.sent,e.abrupt("return",r.modifyUser);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),M=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            mutation {\n                deleteUser(id: "'.concat(t,'"){\n                    id\n                }\n            }')},e.next=3,S(n);case 3:return a=e.sent,e.abrupt("return",a.deleteUser);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleSubmit=function(e){if(e.preventDefault(),a.state.user.password===a.state.user.checkPw){var t={username:a.state.user.username,email:a.state.user.email,password:a.state.user.password,description:"Welcome to my profile!"};T(t).then((function(e){void 0!==e.error?a.setState({errorMessage:"Cannot signup. Username, password or email needs to be changed."}):a.setState({userCreated:!0})}))}else a.setState({errorMessage:"Passwords do not match."})},a.state={user:{username:"",email:"",password:"",checkPw:""},errorMessage:"",userCreated:!1},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.value,a=t.name;this.setState((function(e){return{user:Object(c.a)(Object(c.a)({},e.user),{},Object(k.a)({},a,n))}}))}},{key:"render",value:function(){return this.state.userCreated?Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:"User has been successfully created."}),Object(b.jsx)(h.b,{to:"/login",children:"Back to Login page"})]}):Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:" d-inline-flex",children:Object(b.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(b.jsx)("h1",{children:"Sign Up"}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"username",children:"Username"}),Object(b.jsx)("input",{type:"text",className:"form-control",name:"username",value:this.state.username,onChange:this.handleChange})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"email",children:"Email Address"}),Object(b.jsx)("input",{type:"email",className:"form-control",name:"email",value:this.state.email,onChange:this.handleChange})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"password",children:"Password"}),Object(b.jsx)("input",{type:"password",className:"form-control",name:"password",value:this.state.password,onChange:this.handleChange})]}),Object(b.jsxs)("div",{for:"checkPw",className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"checkPw",children:"Password again"}),Object(b.jsx)("input",{type:"password",className:"form-control",name:"checkPw",value:this.state.checkPw,onChange:this.handleChange})]}),Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:this.state.errorMessage})}),Object(b.jsx)("div",{children:Object(b.jsxs)("p",{children:["Already have an account? ",Object(b.jsx)(h.b,{to:"/login",children:"Login here!"})]})}),Object(b.jsx)("button",{type:"submit",className:"btn btn-danger",children:"Sign Up"})]})})})}}]),n}(r.a.Component),P=Object(j.f)(E);var q=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(P,{})})},A=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).getUserId=function(){var e=window.location.href.split("/");return e[e.length-1]},a.getUser=function(e){R(e).then((function(e){a.setState({user:e,edits:e.description,loading:!1}),e.id===localStorage.getItem("currentUser")&&a.setState({userProfile:!0})}))},a.editDescription=function(e){e.preventDefault();var t={username:a.state.user.username,email:a.state.user.email,description:a.state.edits};L(t,localStorage.getItem("currentUser")).then((function(e){void 0!==e.error?console.log(e.error):window.location.reload()}))},a.userDescription=function(){return a.state.editing?Object(b.jsx)("div",{className:"d-flex flex-column",children:Object(b.jsxs)("form",{id:"descform",onSubmit:a.editDescription,children:[Object(b.jsx)("div",{className:"mb-3",children:Object(b.jsx)("textarea",{form:"descform",className:"form-control",name:"edits",value:a.state.edits,onChange:a.handleChange})}),Object(b.jsx)("button",{className:"btn btn-danger m-3",type:"submit",children:"Save"})]})}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:a.state.user.description})})},a.handleEditBtn=function(e){e.preventDefault(),a.setState({editing:!a.state.editing})},a.editBtn=function(){if(a.state.userProfile&&!1===a.state.editing)return Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn btn-danger m-3",onClick:a.handleEditBtn,children:"Edit profile"})})},a.state={user:[],edits:"",editing:!1,userProfile:!1,loading:!0},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleEditBtn=a.handleEditBtn.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target.value,n=e.target.name;this.setState((function(e){return Object(k.a)({},n,t)}))}},{key:"componentDidMount",value:function(){var e=this.getUserId();this.getUser(e)}},{key:"render",value:function(){return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.user?Object(b.jsxs)("div",{className:"p-5 w-100",children:[Object(b.jsx)("h2",{children:this.state.user.username}),this.userDescription(),this.editBtn()]}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"This user does not exist"})})}}]),n}(r.a.Component),F=Object(j.f)(A),W=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n             {\n                reviewsByBook(BookID: "'.concat(t,'"){\n                id, \n                Title, \n                Content,\n                Rating,\n                BookTitle,\n                BookID,\n                UserID {\n                    id,\n                    username\n                  }\n                }\n            }')},e.next=3,S(n);case 3:return a=e.sent,e.abrupt("return",a.reviewsByBook);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n             {\n                reviewsByUser(UserID: "'.concat(t,'"){\n                id, \n                Title, \n                Content,\n                Rating,\n                BookTitle,\n                BookID,\n                UserID {\n                    id,\n                    username\n                  }\n                }\n            }')},e.next=3,S(n);case 3:return a=e.sent,e.abrupt("return",a.reviewsByUser);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n             {\n                review(id: "'.concat(t,'"){\n                id, \n                Title, \n                Content,\n                Rating,\n                BookTitle,\n                BookID,\n                UserID {\n                    id\n                    username\n                  }\n                }\n            }')},e.next=3,S(n);case 3:return a=e.sent,e.abrupt("return",a.review);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            mutation {\n                addReview(\n                BookID: "'.concat(t.BookID,'", \n                BookTitle: "').concat(t.BookTitle,'", \n                UserID: "').concat(t.UserID,'",\n                Title: "').concat(t.Title,'",\n                Content: "').concat(t.Content,'",\n                Rating: "').concat(t.Rating,'"\n                ) {\n                id, \n                Title, \n                Content\n                }\n            }')},e.next=3,S(n);case 3:return a=e.sent,e.abrupt("return",a.addReview);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(y.a)(C.a.mark((function e(t,n){var a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={query:'\n            mutation {\n                modifyReview(\n                id: "'.concat(n,'",\n                Title: "').concat(t.Title,'",\n                Content: "').concat(t.Content,'",\n                Rating: "').concat(t.Rating,'"\n                ) {\n                id, \n                Title, \n                Content\n                }\n            }')},e.next=3,S(a);case 3:return r=e.sent,e.abrupt("return",r.modifyReview);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),K=function(){var e=Object(y.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            mutation {\n                deleteReview(id: "'.concat(t,'"){\n                    id\n                }\n            }')},e.next=3,S(n);case 3:return a=e.sent,e.abrupt("return",a.deleteReview);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).getUserId=function(){var e=window.location.href.split("/");return e[e.length-1]},a.getReviews=function(e){J(e).then((function(e){a.setState({reviews:e,loading:!1})}))},a.state={reviews:[],loading:!0},a.getReviews=a.getReviews.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.getUserId();this.getReviews(e)}},{key:"render",value:function(){return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.reviews[0]?Object(b.jsxs)("div",{className:"p-2 w-100",children:[Object(b.jsx)("h4",{className:"mt-3",children:"Reviews by this user:"}),this.state.reviews.map((function(e){return Object(b.jsx)("div",{className:"mb-3 border-top border-dark",children:Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/review/".concat(e.id),children:Object(b.jsxs)("div",{children:[Object(b.jsx)("h5",{className:"mt-2",children:e.Title}),Object(b.jsx)("p",{className:"small",children:e.BookTitle})]})})},e.id)}))," "]}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"No reviews"})})}}]),n}(r.a.Component);var G=function(e){return Object(b.jsxs)("div",{className:"d-flex flex-row",children:[Object(b.jsx)(F,{}),Object(b.jsx)(Y,{})]})},Q=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).getBookId=function(){var e=window.location.href.split("/");return e[e.length-1]},a.getBookInfo=function(e){O(e).then((function(e){void 0!==e?a.setState({bookInfo:e,loading:!1}):console.log("Error retrieving data.")}))},a.showBookAuthors=function(e){if(void 0!==e.volumeInfo.authors)return Object(b.jsx)("div",{children:e.volumeInfo.authors.map((function(e){return Object(b.jsx)("p",{children:e})}))})},a.showCover=function(e){return void 0!==e.volumeInfo.imageLinks?Object(b.jsx)("img",{className:"mt-3",src:e.volumeInfo.imageLinks.thumbnail,alt:e.volumeInfo.title}):Object(b.jsx)("p",{className:"mt-3 mb-3",children:"No image available"})},a.writeReview=function(){if(null!==localStorage.getItem("token"))return Object(b.jsx)("div",{children:Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/write/".concat(a.state.bookInfo.id),children:"Write review"})})},a.componentDidMount=function(){var e=a.getBookId();a.getBookInfo(e)},a.componentWillUnmount=function(){a.setState=function(e,t){}},a.state={bookInfo:[],loading:!0,authorKey:0},a.handleClick=a.handleClick.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.history.push("/write")}},{key:"render",value:function(){return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0===this.state.bookInfo.volumeInfo?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"error"})}):Object(b.jsx)("div",{className:"p-2 m-3",children:Object(b.jsxs)("div",{children:[this.showCover(this.state.bookInfo),Object(b.jsx)("h3",{children:this.state.bookInfo.volumeInfo.title}),this.showBookAuthors(this.state.bookInfo),this.writeReview()]})})}}]),n}(r.a.Component),X=Object(j.f)(Q),Z=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).getBookId=function(){var e=window.location.href.split("/");return e[e.length-1]},a.state={reviews:[],users:[],showContent:!0,loading:!0},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.getReviews=a.getReviews.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"handleChange",value:function(e){this.setState((function(e){return{showContent:!e.showContent}}))}},{key:"getReviews",value:function(e){var t=this;W(e).then((function(e){t.setState({reviews:e,loading:!1})}))}},{key:"getContent",value:function(e){if(this.state.showContent)return Object(b.jsx)("p",{children:e.Content})}},{key:"componentDidMount",value:function(){var e=this.getBookId();this.getReviews(e)}},{key:"render",value:function(){var e=this;return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.reviews[0]?Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{className:"mt-3",children:[Object(b.jsx)("input",{className:"me-1",type:"checkbox",id:"sc",name:"showContent",value:this.state.value,onClick:this.handleChange}),Object(b.jsx)("label",{for:"sc",children:"Hide full reviews"}),Object(b.jsx)("br",{})]}),Object(b.jsx)("div",{className:"p-5 w-100 flex-column",children:this.state.reviews.map((function(t){return Object(b.jsx)("div",{className:"mb-3 border-bottom border-dark",children:Object(b.jsxs)("div",{className:"mb-3 ",children:[Object(b.jsx)("div",{className:"row",children:Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/review/".concat(t.id),children:Object(b.jsxs)("h3",{children:[t.Title," ",Object(b.jsxs)("small",{class:"text-muted",children:[t.Rating,"/5"]})]})})}),e.getContent(t),Object(b.jsx)(h.b,{className:"link-dark fw-bold",to:"/users/".concat(t.UserID.id),children:t.UserID.username})]})},t.id)}))})]}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"No reviews"})})}}]),n}(r.a.Component);var $=function(e){return Object(b.jsxs)("div",{className:"d-flex flex-row",children:[Object(b.jsx)(X,Object(c.a)({},e)),Object(b.jsx)(Z,Object(c.a)({},e))]})},_=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).getBookId=function(){var e=window.location.href.split("/");return e[e.length-1]},a.getBookInfo=function(e){O(e).then((function(e){void 0!==e?a.setState({book:e}):console.log("Error retrieving book.")}))},a.handleSubmit=function(e){e.preventDefault();var t={BookID:a.state.book.id,UserID:localStorage.getItem("currentUser"),BookTitle:a.state.book.volumeInfo.title,Title:a.state.review.title,Content:a.state.review.content,Rating:a.state.review.Rating};z(t).then((function(e){void 0!==e.error?console.log("ERROR "+e.error):a.props.history.push("/book/".concat(a.state.book.id))}))},a.componentDidMount=function(){var e=a.getBookId();a.getBookInfo(e)},a.state={book:[],review:{title:"",content:"",rating:0},errorMessage:""},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.value,a=t.name;this.setState((function(e){return{review:Object(c.a)(Object(c.a)({},e.review),{},Object(k.a)({},a,n))}}))}},{key:"render",value:function(){return Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:"d-inline-flex",children:Object(b.jsxs)("form",{id:"writeform",onSubmit:this.handleSubmit,children:[Object(b.jsx)("h2",{children:"Write review"}),Object(b.jsxs)("div",{className:"col-auto",children:[Object(b.jsx)("label",{className:"form-label",children:"Rating"}),Object(b.jsx)("br",{}),Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate1",name:"Rating",value:"1",onChange:this.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate1",children:"1"}),Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate2",name:"Rating",value:"2",onChange:this.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate2",children:"2"}),Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate3",name:"Rating",value:"3",onChange:this.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate3",children:"3"}),Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate4",name:"Rating",value:"4",onChange:this.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate4",children:"4"}),Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate5",name:"Rating",value:"5",onChange:this.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate5",children:"5"}),Object(b.jsx)("br",{}),Object(b.jsx)("label",{for:"reviewtitle",className:"form-label",children:"Title"})]}),Object(b.jsx)("div",{className:"mb-3",children:Object(b.jsx)("input",{id:"reviewtitle",type:"text",className:"form-control",name:"title",label:"Title",value:this.state.review.title,onChange:this.handleChange})}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{for:"contenttext",className:"form-label",children:"Your review"}),Object(b.jsx)("textarea",{id:"contenttext",form:"writeform",className:"form-control",name:"content",value:this.state.review.content,onChange:this.handleChange})]}),Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:this.state.errorMessage})}),Object(b.jsx)("button",{className:"btn btn-danger m-3",type:"submit",children:"Submit review"})]})})})}}]),n}(r.a.Component),ee=Object(j.f)(_);var te=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(ee,{})})},ne=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).getReviewId=function(){var e=window.location.href.split("/");return e[e.length-1]},a.getUser=function(e){void 0!==a.state.review?R(e).then((function(e){a.setState((function(t){return{user:e}}))})):setTimeout(a.getUser(e),1e3)},a.findUser=function(e){var t=a.state.user.findIndex((function(t){return t.id===e})),n=a.state.user[t];return void 0===n?"":n.username},a.getBookData=function(e){O(e).then((function(e){void 0!==e?a.setState({book:e}):console.log("Error retrieving book.")}))},a.reviewEdit=function(e){e.preventDefault();var t={Title:a.state.review.Title,Content:a.state.edits,Rating:a.state.Rating};H(t,a.state.review.id).then((function(e){void 0!==e.error?console.log(e.error):window.location.reload()}))},a.handleEditBtn=function(e){e.preventDefault(),a.setState({editing:!a.state.editing})},a.handleDelete=function(e){e.preventDefault(),K(a.state.review.id,localStorage.getItem("token")).then((function(e){void 0!==e.error?console.log(e.error):a.props.history.push("/users/".concat(localStorage.getItem("currentUser")))}))},a.contentView=function(){return a.state.editing?Object(b.jsx)("div",{className:"d-flex flex-column",children:Object(b.jsxs)("form",{id:"editform",onSubmit:a.reviewEdit,children:[Object(b.jsxs)("div",{className:"col-auto",children:[Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate1",name:"Rating",value:"1",onChange:a.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate1",children:"1"}),Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate2",name:"Rating",value:"2",onChange:a.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate2",children:"2"}),Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate3",name:"Rating",value:"3",onChange:a.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate3",children:"3"}),Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate4",name:"Rating",value:"4",onChange:a.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate4",children:"4"}),Object(b.jsx)("input",{className:"me-1",type:"radio",id:"rate5",name:"Rating",value:"5",onChange:a.handleChange}),Object(b.jsx)("label",{className:"me-3",for:"rate5",children:"5"}),Object(b.jsx)("br",{})]}),Object(b.jsx)("div",{className:"input-group mb-3",children:Object(b.jsx)("textarea",{id:"reviewediting",form:"editform",className:"form-control mt-3",name:"edits",value:a.state.edits,onChange:a.handleChange})}),Object(b.jsx)("button",{className:"btn btn-danger m-3",type:"submit",children:"Save"})]})}):Object(b.jsxs)("div",{children:[Object(b.jsxs)("p",{children:[a.state.review.Rating,"/5"]}),Object(b.jsx)("p",{children:a.state.review.Content}),Object(b.jsx)(h.b,{className:"link-dark fw-bold",to:"/users/".concat(a.state.review.UserID.id),children:a.state.review.UserID.username})]})},a.editBtn=function(){if(a.state.viewerWriter&&!1===a.state.editing)return Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn btn-danger m-3",onClick:a.handleEditBtn,children:"Edit review"})})},a.deleteBtn=function(){if(a.state.viewerWriter)return Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn btn-danger mt-5 m-3",onClick:a.handleDelete,children:"Delete review"})})},a.showCover=function(e){return void 0!==e.volumeInfo.imageLinks?Object(b.jsx)("img",{className:"mt-3",src:e.volumeInfo.imageLinks.thumbnail,alt:e.volumeInfo.title}):Object(b.jsx)("p",{className:"mt-3 mb-3",children:"No image available"})},a.showBookAuthors=function(e){if(void 0!==e.volumeInfo.authors)return Object(b.jsx)("div",{children:e.volumeInfo.authors.map((function(e){return Object(b.jsx)("p",{children:e})}))})},a.state={review:[],edits:"",Rating:0,user:[],book:[],viewerWriter:!1,editing:!1,loading:!0},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.getReview=a.getReview.bind(Object(v.a)(a)),a.reviewEdit=a.reviewEdit.bind(Object(v.a)(a)),a.handleEditBtn=a.handleEditBtn.bind(Object(v.a)(a)),a.handleDelete=a.handleDelete.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target.value,n=e.target.name;this.setState((function(e){return Object(k.a)({},n,t)}))}},{key:"getReview",value:function(e){var t=this;V(e).then((function(e){t.setState({review:e,loading:!1}),t.getUser(e.UserID.id),t.getBookData(e.BookID),localStorage.getItem("currentUser")===e.UserID.id&&t.setState({viewerWriter:!0,edits:e.Content})}))}},{key:"componentDidMount",value:function(){var e=this.getReviewId();this.getReview(e)}},{key:"render",value:function(){return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.review.Title&&void 0!==this.state.book.volumeInfo?Object(b.jsxs)("div",{className:"d-flex flex-row",children:[Object(b.jsx)("div",{children:Object(b.jsxs)("div",{className:"p-2 m-3",children:[this.showCover(this.state.book),Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/book/".concat(this.state.book.id),children:Object(b.jsx)("h2",{children:this.state.book.volumeInfo.title})}),this.showBookAuthors(this.state.book),this.deleteBtn()]})}),Object(b.jsxs)("div",{className:"p-5 w-100",children:[Object(b.jsx)("h3",{children:this.state.review.Title}),this.contentView(),this.editBtn()]})]}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})})}}]),n}(r.a.Component),ae=Object(j.f)(ne);var re=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(ae,{})})},se=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).removeUser=function(e){M(e).then((function(e){void 0!==e.error?console.log("what "+e.error):(localStorage.clear(),a.props.history.push("/login"))}))},a.handleClick=function(e){e.preventDefault(),a.removeUser(localStorage.getItem("currentUser"))},a.handleClick=a.handleClick.bind(Object(v.a)(a)),a}return Object(l.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn btn-danger m-3",onClick:this.handleClick,children:"Delete user"})})}}]),n}(r.a.Component),ie=Object(j.f)(se);var ce=function(e){return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Settings"}),Object(b.jsx)(ie,{})]})},oe=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).setUser=function(e){a.setState({user:e})},a.state={user:null},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{className:"App",children:Object(b.jsx)("div",{className:"container",children:Object(b.jsxs)(h.a,{basename:"",children:[Object(b.jsx)(m,{}),Object(b.jsxs)(j.c,{children:[Object(b.jsx)(j.a,{exact:!0,path:"/",render:function(e){return Object(b.jsx)(w,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/login",render:function(t){return Object(b.jsx)(U,Object(c.a)(Object(c.a)({},t),{},{state:e.state,setUser:e.setUser}))}}),Object(b.jsx)(j.a,{exact:!0,path:"/signup",render:function(e){return Object(b.jsx)(q,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/users/:id",render:function(e){return Object(b.jsx)(G,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/book/:id",render:function(e){return Object(b.jsx)($,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/write/:id",render:function(e){return Object(b.jsx)(te,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/review/:id",render:function(e){return Object(b.jsx)(re,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/settings",render:function(e){return Object(b.jsx)(ce,Object(c.a)({},e))}})]})]})})})}}]),n}(r.a.Component),le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),s(e),i(e)}))};i.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(oe,{})}),document.getElementById("root")),le()}},[[39,1,2]]]);
//# sourceMappingURL=main.96a14a19.chunk.js.map