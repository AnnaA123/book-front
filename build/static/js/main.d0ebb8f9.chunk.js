(this["webpackJsonpbook-site-front"]=this["webpackJsonpbook-site-front"]||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(24),i=n.n(s),c=(n(30),n(9)),o=n(5),l=n(6),d=n(8),u=n(7),h=n(3),j=n(10),b=(n(31),n(0));var v=Object(j.f)((function(){return null!==localStorage.getItem("token")?Object(b.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-danger",children:Object(b.jsxs)("div",{className:"container-fluid",children:[Object(b.jsx)(h.b,{className:"navbar-brand",to:"/",children:"BookSide"}),Object(b.jsx)("div",{children:Object(b.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/",children:"Search"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/users/".concat(localStorage.getItem("currentUser")),children:"Profile"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/settings",children:"Settings"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/login",onClick:function(){localStorage.clear()},children:"Logout"})})]})})]})}):Object(b.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-danger",children:Object(b.jsxs)("div",{className:"container-fluid",children:[Object(b.jsx)(h.b,{className:"navbar-brand",to:"/",children:"BookSight"}),Object(b.jsx)("div",{children:Object(b.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/",children:"Search"})}),Object(b.jsx)("li",{className:"nav-item",children:Object(b.jsx)(h.b,{className:"nav-link",to:"/login",children:"Login"})})]})})]})})})),m=n(2),f="https://www.googleapis.com/books",O=function(e){return fetch(f+"/v1/volumes/"+e).then((function(e){return e.json()}))},x=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).getBooks=function(){var e;(e=r.state.searchTitle,fetch(f+"/v1/volumes?q=search+"+e).then((function(e){return e.json()}))).then((function(e){r.setState({books:e.items,loading:!1})}))},r.showThumbnail=function(e){return void 0!==e.volumeInfo.imageLinks?Object(b.jsx)("img",{className:"mt-3",src:e.volumeInfo.imageLinks.thumbnail,alt:e.volumeInfo.title}):Object(b.jsx)("p",{className:"mt-3",children:"(No image available)"})},r.componentDidMount=function(){r.getBooks()},r.state={books:[],searchTitle:e.sTitle,loading:!0},r.getBooks=r.getBooks.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.books?Object(b.jsx)("div",{className:"row row-cols-3",children:this.state.books.map((function(t){return Object(b.jsx)("div",{className:"col col-sm-4 border border-white",children:Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/book/".concat(t.id),children:Object(b.jsxs)("div",{children:[e.showThumbnail(t),Object(b.jsx)("p",{children:t.volumeInfo.title})]})},t.id)},t.id)}))}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"No search results"})})}}]),n}(a.a.Component),g=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).toggler=function(){r.setState((function(e){return{toggle:!e.toggle}}))},r.searchResults=function(){if(r.state.toggle)return Object(b.jsx)("div",{children:Object(b.jsx)(x,{sTitle:r.state.searchTitle})})},r.handleTitleSearch=function(e){e.preventDefault(),r.setState((function(e){return{byAuthor:!1}})),r.toggler()},r.handleChange=function(e){e.preventDefault();var t=e.target.value;r.setState((function(){return{toggle:!1,searchTitle:t}}))},r.state={searchTitle:"",byAuthor:!1,toggle:!1},r.handleChange=r.handleChange.bind(Object(m.a)(r)),r.handleTitleSearch=r.handleTitleSearch.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"container",children:[Object(b.jsx)("div",{className:"d-inline-flex",children:Object(b.jsx)("form",{onSubmit:this.handleTitleSearch,children:Object(b.jsxs)("div",{className:"row g-3 align-items-center mt-1",children:[Object(b.jsx)("div",{className:"col-auto",children:Object(b.jsx)("label",{for:"searchTitle",className:"col-form-label",children:"Search for books"})}),Object(b.jsx)("div",{className:"col-auto",children:Object(b.jsx)("input",{className:"form-control",type:"search",placeholder:"Search",name:"searchTitle",value:this.state.searchTitle,onChange:this.handleChange})}),Object(b.jsx)("div",{className:"col-auto",children:Object(b.jsx)("button",{className:"btn btn-outline-danger",type:"submit",children:"Search"})})]})})}),Object(b.jsx)("div",{className:"mt-3",children:this.searchResults()})]})}}]),n}(a.a.Component);var p=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)("div",{children:Object(b.jsx)(g,{})})})},w=n(15),k=n(4),N=n.n(k),C=n(12),y=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",authorization:"bearer "+localStorage.getItem("token")},body:JSON.stringify(t)},e.prev=1,e.next=4,fetch("https://booksight.jelastic.metropolia.fi/graphql",n);case 4:return r=e.sent,e.next=7,r.json();case 7:return a=e.sent,e.abrupt("return",a.data);case 11:return e.prev=11,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            {\n                login(\n                username: "'.concat(t.username,'",\n                password: "').concat(t.password,'"\n                ) {\n                id,\n                username,\n                token\n                }\n            }')},e.next=3,y(n);case 3:return r=e.sent,e.abrupt("return",r.login);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).doLogin=function(){var e={username:r.state.user.username,password:r.state.user.password};S(e).then((function(e){if(null!==e){if(void 0!==e.username){var t=r.props.setUser(e);return localStorage.setItem("token",e.token),localStorage.setItem("currentUser",e.id),r.props.history.push("/"),t}r.setState({errorMessage:"Username or password is incorrect."})}else r.setState({errorMessage:"Something went wrong"})}))},r.state={user:{username:"",password:""},errorMessage:"",validUser:!0},r.handleChange=r.handleChange.bind(Object(m.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(m.a)(r)),r.doLogin=r.doLogin.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.value,r=t.name;this.setState((function(e){return{user:Object(c.a)(Object(c.a)({},e.user),{},Object(w.a)({},r,n))}}))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.doLogin()}},{key:"render",value:function(){return Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:"d-inline-flex",children:Object(b.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(b.jsx)("h1",{children:"Login"}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"username",className:"form-label",children:"Username"}),Object(b.jsx)("input",{type:"text",className:"form-control height=200px",name:"username",id:"username",label:"Username",value:this.state.user.username,onChange:this.handleChange})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"password",children:"Password"}),Object(b.jsx)("input",{type:"password",className:"form-control",name:"password",id:"password",label:"Password",value:this.state.user.password,onChange:this.handleChange})]}),Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:this.state.errorMessage})}),Object(b.jsxs)("div",{children:[Object(b.jsxs)("p",{children:["Don't have an account yet? ",Object(b.jsx)(h.b,{to:"/signup",children:"Sign up here!"})]}),Object(b.jsx)("p",{children:"\n"})]}),Object(b.jsx)("button",{type:"submit",className:"btn btn-danger",children:"Login"})]})})})}}]),n}(a.a.Component),B=Object(j.f)(I);var U=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(B,{setUser:e.setUser})})},D=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n             {\n                user(id: "'.concat(t,'"){\n                    id, \n                    username,\n                    email,\n                    description\n                }\n            }')},e.next=3,y(n);case 3:return r=e.sent,e.abrupt("return",r.user);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            mutation {\n                signup(\n                username: "'.concat(t.username,'", \n                password: "').concat(t.password,'", \n                email: "').concat(t.email,'",\n                description: "').concat(t.description,'",\n                ){\n                id, \n                username\n                }\n            }')},e.next=3,y(n);case 3:return r=e.sent,e.abrupt("return",r.signup);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(C.a)(N.a.mark((function e(t,n){var r,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={query:'\n            mutation {\n                modifyUser(\n                id: "'.concat(n,'",\n                username: "').concat(t.username,'",\n                email: "').concat(t.email,'",\n                description: "').concat(t.description,'",\n                ) {\n                id, \n                username,\n                description\n                }\n            }')},e.next=3,y(r);case 3:return a=e.sent,e.abrupt("return",a.modifyUser);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            mutation {\n                deleteUser(id: "'.concat(t,'"){\n                    id\n                }\n            }')},e.next=3,y(n);case 3:return r=e.sent,e.abrupt("return",r.deleteUser);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).handleSubmit=function(e){if(e.preventDefault(),r.state.user.password===r.state.user.checkPw){var t={username:r.state.user.username,email:r.state.user.email,password:r.state.user.password,description:"Welcome to my profile!"};T(t).then((function(e){void 0!==e.error?r.setState({errorMessage:"Cannot signup. Username, password or email needs to be changed."}):r.setState({userCreated:!0})}))}else r.setState({errorMessage:"Passwords do not match."})},r.state={user:{username:"",email:"",password:"",checkPw:""},errorMessage:"",userCreated:!1},r.handleChange=r.handleChange.bind(Object(m.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.value,r=t.name;this.setState((function(e){return{user:Object(c.a)(Object(c.a)({},e.user),{},Object(w.a)({},r,n))}}))}},{key:"render",value:function(){return this.state.userCreated?Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:"User has been successfully created."}),Object(b.jsx)(h.b,{to:"/login",children:"Back to Login page"})]}):Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:" d-inline-flex",children:Object(b.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(b.jsx)("h1",{children:"Sign Up"}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"username",children:"Username"}),Object(b.jsx)("input",{type:"text",className:"form-control",name:"username",value:this.state.username,onChange:this.handleChange})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"email",children:"Email Address"}),Object(b.jsx)("input",{type:"email",className:"form-control",name:"email",value:this.state.email,onChange:this.handleChange})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"password",children:"Password"}),Object(b.jsx)("input",{type:"password",className:"form-control",name:"password",value:this.state.password,onChange:this.handleChange})]}),Object(b.jsxs)("div",{for:"checkPw",className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"checkPw",children:"Password again"}),Object(b.jsx)("input",{type:"password",className:"form-control",name:"checkPw",value:this.state.checkPw,onChange:this.handleChange})]}),Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:this.state.errorMessage})}),Object(b.jsx)("div",{children:Object(b.jsxs)("p",{children:["Already have an account? ",Object(b.jsx)(h.b,{to:"/login",children:"Login here!"})]})}),Object(b.jsx)("button",{type:"submit",className:"btn btn-danger",children:"Sign Up"})]})})})}}]),n}(a.a.Component),M=Object(j.f)(E);var P=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(M,{})})},q=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).getUserId=function(){var e=window.location.href.split("/");return e[e.length-1]},r.getUser=function(e){D(e).then((function(e){r.setState({user:e,edits:e.description,loading:!1}),e.id===localStorage.getItem("currentUser")&&r.setState({userProfile:!0})}))},r.editDescription=function(e){e.preventDefault();var t={username:r.state.user.username,email:r.state.user.email,description:r.state.edits};R(t,localStorage.getItem("currentUser")).then((function(e){void 0!==e.error?console.log(e.error):window.location.reload()}))},r.userDescription=function(){return r.state.editing?Object(b.jsx)("div",{className:"d-flex flex-column",children:Object(b.jsxs)("form",{id:"descform",onSubmit:r.editDescription,children:[Object(b.jsx)("div",{className:"mb-3",children:Object(b.jsx)("textarea",{form:"descform",className:"form-control",name:"edits",value:r.state.edits,onChange:r.handleChange})}),Object(b.jsx)("button",{className:"btn btn-danger m-3",type:"submit",children:"Save"})]})}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:r.state.user.description})})},r.handleEditBtn=function(e){e.preventDefault(),r.setState({editing:!r.state.editing})},r.editBtn=function(){if(r.state.userProfile&&!1===r.state.editing)return Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn btn-danger m-3",onClick:r.handleEditBtn,children:"Edit profile"})})},r.state={user:[],edits:"",editing:!1,userProfile:!1,loading:!0},r.handleChange=r.handleChange.bind(Object(m.a)(r)),r.handleEditBtn=r.handleEditBtn.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target.value,n=e.target.name;this.setState((function(e){return Object(w.a)({},n,t)}))}},{key:"componentDidMount",value:function(){var e=this.getUserId();this.getUser(e)}},{key:"render",value:function(){return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.user?Object(b.jsxs)("div",{className:"p-5 w-100",children:[Object(b.jsx)("h2",{children:this.state.user.username}),this.userDescription(),this.editBtn()]}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"This user does not exist"})})}}]),n}(a.a.Component),A=Object(j.f)(q),F=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n             {\n                reviewsByBook(BookID: "'.concat(t,'"){\n                id, \n                Title, \n                Content,\n                BookTitle,\n                BookID,\n                UserID {\n                    id,\n                    username\n                  }\n                }\n            }')},e.next=3,y(n);case 3:return r=e.sent,e.abrupt("return",r.reviewsByBook);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n             {\n                reviewsByUser(UserID: "'.concat(t,'"){\n                id, \n                Title, \n                Content,\n                BookTitle,\n                BookID,\n                UserID {\n                    id,\n                    username\n                  }\n                }\n            }')},e.next=3,y(n);case 3:return r=e.sent,e.abrupt("return",r.reviewsByUser);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n             {\n                review(id: "'.concat(t,'"){\n                id, \n                Title, \n                Content,\n                BookTitle,\n                BookID,\n                UserID {\n                    id\n                    username\n                  }\n                }\n            }')},e.next=3,y(n);case 3:return r=e.sent,e.abrupt("return",r.review);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            mutation {\n                addReview(\n                BookID: "'.concat(t.BookID,'", \n                BookTitle: "').concat(t.BookTitle,'", \n                UserID: "').concat(t.UserID,'",\n                Title: "').concat(t.Title,'",\n                Content: "').concat(t.Content,'"\n                ) {\n                id, \n                Title, \n                Content\n                }\n            }')},e.next=3,y(n);case 3:return r=e.sent,e.abrupt("return",r.addReview);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(C.a)(N.a.mark((function e(t,n){var r,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={query:'\n            mutation {\n                modifyReview(\n                id: "'.concat(n,'",\n                Title: "').concat(t.Title,'",\n                Content: "').concat(t.Content,'"\n                ) {\n                id, \n                Title, \n                Content\n                }\n            }')},e.next=3,y(r);case 3:return a=e.sent,e.abrupt("return",a.modifyReview);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),K=function(){var e=Object(C.a)(N.a.mark((function e(t){var n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={query:'\n            mutation {\n                deleteReview(id: "'.concat(t,'"){\n                    id\n                }\n            }')},e.next=3,y(n);case 3:return r=e.sent,e.abrupt("return",r.deleteReview);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).getUserId=function(){var e=window.location.href.split("/");return e[e.length-1]},r.getReviews=function(e){W(e).then((function(e){r.setState({reviews:e,loading:!1})}))},r.state={reviews:[],loading:!0},r.getReviews=r.getReviews.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.getUserId();this.getReviews(e)}},{key:"render",value:function(){return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.reviews[0]?Object(b.jsxs)("div",{className:"p-2 w-100",children:[Object(b.jsx)("h4",{className:"mt-3",children:"Reviews by this user:"}),this.state.reviews.map((function(e){return Object(b.jsx)("div",{className:"mb-3 border-top border-dark",children:Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/review/".concat(e.id),children:Object(b.jsxs)("div",{children:[Object(b.jsx)("h5",{className:"mt-2",children:e.Title}),Object(b.jsx)("p",{className:"small",children:e.BookTitle})]})})},e.id)}))," "]}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"No reviews"})})}}]),n}(a.a.Component);var G=function(e){return Object(b.jsxs)("div",{className:"d-flex flex-row",children:[Object(b.jsx)(A,{}),Object(b.jsx)(Y,{})]})},H=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).getBookId=function(){var e=window.location.href.split("/");return e[e.length-1]},r.getBookInfo=function(e){O(e).then((function(e){void 0!==e?r.setState({bookInfo:e,loading:!1}):console.log("Error retrieving data.")}))},r.showBookAuthors=function(e){if(void 0!==e.volumeInfo.authors)return Object(b.jsx)("div",{children:e.volumeInfo.authors.map((function(e){return Object(b.jsx)("p",{children:e})}))})},r.showCover=function(e){return void 0!==e.volumeInfo.imageLinks?Object(b.jsx)("img",{className:"mt-3",src:e.volumeInfo.imageLinks.thumbnail,alt:e.volumeInfo.title}):Object(b.jsx)("p",{className:"mt-3 mb-3",children:"No image available"})},r.writeReview=function(){if(null!==localStorage.getItem("token"))return Object(b.jsx)("div",{children:Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/write/".concat(r.state.bookInfo.id),children:"Write review"})})},r.componentDidMount=function(){var e=r.getBookId();r.getBookInfo(e)},r.componentWillUnmount=function(){r.setState=function(e,t){}},r.state={bookInfo:[],loading:!0,authorKey:0},r.handleClick=r.handleClick.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.history.push("/write")}},{key:"render",value:function(){return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0===this.state.bookInfo.volumeInfo?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"error"})}):Object(b.jsx)("div",{className:"p-2 m-3",children:Object(b.jsxs)("div",{children:[this.showCover(this.state.bookInfo),Object(b.jsx)("h3",{children:this.state.bookInfo.volumeInfo.title}),this.showBookAuthors(this.state.bookInfo),this.writeReview()]})})}}]),n}(a.a.Component),Q=Object(j.f)(H),X=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).getBookId=function(){var e=window.location.href.split("/");return e[e.length-1]},r.state={reviews:[],users:[],loading:!0},r.getReviews=r.getReviews.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"getReviews",value:function(e){var t=this;F(e).then((function(e){t.setState({reviews:e,loading:!1})}))}},{key:"componentDidMount",value:function(){var e=this.getBookId();this.getReviews(e)}},{key:"render",value:function(){return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.reviews[0]?Object(b.jsx)("div",{className:"p-5 w-100 flex-column",children:this.state.reviews.map((function(e){return Object(b.jsx)("div",{className:"mb-3 border-bottom border-dark",children:Object(b.jsxs)("div",{className:"mb-3 ",children:[Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/review/".concat(e.id),children:Object(b.jsx)("h3",{children:e.Title})}),Object(b.jsx)("p",{children:e.Content}),Object(b.jsx)(h.b,{className:"link-dark fw-bold",to:"/users/".concat(e.UserID.id),children:e.UserID.username})]})},e.id)}))}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"No reviews"})})}}]),n}(a.a.Component);var Z=function(e){return Object(b.jsxs)("div",{className:"d-flex flex-row",children:[Object(b.jsx)(Q,Object(c.a)({},e)),Object(b.jsx)(X,Object(c.a)({},e))]})},$=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).getBookId=function(){var e=window.location.href.split("/");return e[e.length-1]},r.getBookInfo=function(e){O(e).then((function(e){void 0!==e?r.setState({book:e}):console.log("Error retrieving book.")}))},r.handleSubmit=function(e){e.preventDefault();var t={BookID:r.state.book.id,UserID:localStorage.getItem("currentUser"),BookTitle:r.state.book.volumeInfo.title,Title:r.state.review.title,Content:r.state.review.content};V(t).then((function(e){null!==e&&(void 0!==e.error?console.log("ERROR "+e.error):r.props.history.push("/book/".concat(r.state.book.id)))}))},r.componentDidMount=function(){var e=r.getBookId();r.getBookInfo(e)},r.state={book:[],review:{title:"",content:""},errorMessage:""},r.handleChange=r.handleChange.bind(Object(m.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.value,r=t.name;this.setState((function(e){return{review:Object(c.a)(Object(c.a)({},e.review),{},Object(w.a)({},r,n))}}))}},{key:"render",value:function(){return Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:"d-inline-flex",children:Object(b.jsxs)("form",{id:"writeform",onSubmit:this.handleSubmit,children:[Object(b.jsx)("h2",{children:"Write review"}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{for:"reviewtitle",className:"form-label",children:"Title"}),Object(b.jsx)("input",{id:"reviewtitle",type:"text",className:"form-control",name:"title",label:"Title",value:this.state.review.title,onChange:this.handleChange})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{for:"contenttext",className:"form-label",children:"Your review"}),Object(b.jsx)("textarea",{id:"contenttext",form:"writeform",className:"form-control",name:"content",value:this.state.review.content,onChange:this.handleChange})]}),Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:this.state.errorMessage})}),Object(b.jsx)("button",{className:"btn btn-danger m-3",type:"submit",children:"Submit review"})]})})})}}]),n}(a.a.Component),_=Object(j.f)($);var ee=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(_,{})})},te=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).getReviewId=function(){var e=window.location.href.split("/");return e[e.length-1]},r.getUser=function(e){void 0!==r.state.review?D(e).then((function(e){r.setState((function(t){return{user:e}}))})):setTimeout(r.getUser(e),1e3)},r.findUser=function(e){var t=r.state.user.findIndex((function(t){return t.id===e})),n=r.state.user[t];return void 0===n?"":n.username},r.getBookData=function(e){O(e).then((function(e){void 0!==e?r.setState({book:e}):console.log("Error retrieving book.")}))},r.reviewEdit=function(e){e.preventDefault();var t={Title:r.state.review.Title,Content:r.state.edits};z(t,r.state.review.id).then((function(e){void 0!==e.error?console.log(e.error):window.location.reload()}))},r.handleEditBtn=function(e){e.preventDefault(),r.setState({editing:!r.state.editing})},r.handleDelete=function(e){e.preventDefault(),K(r.state.review.id,localStorage.getItem("token")).then((function(e){void 0!==e.error?console.log(e.error):r.props.history.push("/users/".concat(localStorage.getItem("currentUser")))}))},r.contentView=function(){return r.state.editing?Object(b.jsx)("div",{className:"d-flex flex-column",children:Object(b.jsxs)("form",{id:"editform",onSubmit:r.reviewEdit,children:[Object(b.jsx)("div",{className:"input-group mb-3",children:Object(b.jsx)("textarea",{form:"editform",className:"form-control",name:"edits",value:r.state.edits,onChange:r.handleChange})}),Object(b.jsx)("button",{className:"btn btn-danger m-3",type:"submit",children:"Save"})]})}):Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:r.state.review.Content}),Object(b.jsx)(h.b,{className:"link-dark fw-bold",to:"/users/".concat(r.state.review.UserID.id),children:r.state.review.UserID.username})]})},r.editBtn=function(){if(r.state.viewerWriter&&!1===r.state.editing)return Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn btn-danger m-3",onClick:r.handleEditBtn,children:"Edit review"})})},r.deleteBtn=function(){if(r.state.viewerWriter)return Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn btn-danger mt-5 m-3",onClick:r.handleDelete,children:"Delete review"})})},r.showCover=function(e){return void 0!==e.volumeInfo.imageLinks?Object(b.jsx)("img",{className:"mt-3",src:e.volumeInfo.imageLinks.thumbnail,alt:e.volumeInfo.title}):Object(b.jsx)("p",{className:"mt-3 mb-3",children:"No image available"})},r.showBookAuthors=function(e){if(void 0!==e.volumeInfo.authors)return Object(b.jsx)("div",{children:e.volumeInfo.authors.map((function(e){return Object(b.jsx)("p",{children:e})}))})},r.state={review:[],edits:"",user:[],book:[],viewerWriter:!1,editing:!1,loading:!0},r.handleChange=r.handleChange.bind(Object(m.a)(r)),r.getReview=r.getReview.bind(Object(m.a)(r)),r.reviewEdit=r.reviewEdit.bind(Object(m.a)(r)),r.handleEditBtn=r.handleEditBtn.bind(Object(m.a)(r)),r.handleDelete=r.handleDelete.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target.value,n=e.target.name;this.setState((function(e){return Object(w.a)({},n,t)}))}},{key:"getReview",value:function(e){var t=this;J(e).then((function(e){t.setState({review:e,loading:!1}),t.getUser(e.UserID.id),t.getBookData(e.BookID),localStorage.getItem("currentUser")===e.UserID.id&&t.setState({viewerWriter:!0,edits:e.Content})}))}},{key:"componentDidMount",value:function(){var e=this.getReviewId();this.getReview(e)}},{key:"render",value:function(){return this.state.loading?Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})}):void 0!==this.state.review.Title&&void 0!==this.state.book.volumeInfo?Object(b.jsxs)("div",{className:"d-flex flex-row",children:[Object(b.jsx)("div",{children:Object(b.jsxs)("div",{className:"p-2 m-3",children:[this.showCover(this.state.book),Object(b.jsx)(h.b,{className:"link-danger text-decoration-none",to:"/book/".concat(this.state.book.id),children:Object(b.jsx)("h2",{children:this.state.book.volumeInfo.title})}),this.showBookAuthors(this.state.book),this.deleteBtn()]})}),Object(b.jsxs)("div",{className:"p-5 w-100",children:[Object(b.jsx)("h3",{children:this.state.review.Title}),this.contentView(),this.editBtn()]})]}):Object(b.jsx)("div",{children:Object(b.jsx)("p",{children:"Loading..."})})}}]),n}(a.a.Component),ne=Object(j.f)(te);var re=function(e){return Object(b.jsx)("div",{children:Object(b.jsx)(ne,{})})},ae=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).removeUser=function(e){L(e).then((function(e){void 0!==e.error?console.log("what "+e.error):(localStorage.clear(),r.props.history.push("/login"))}))},r.handleClick=function(e){e.preventDefault(),r.removeUser(localStorage.getItem("currentUser"))},r.handleClick=r.handleClick.bind(Object(m.a)(r)),r}return Object(l.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn btn-danger m-3",onClick:this.handleClick,children:"Delete user"})})}}]),n}(a.a.Component),se=Object(j.f)(ae);var ie=function(e){return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Settings"}),Object(b.jsx)(se,{})]})},ce=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).setUser=function(e){r.setState({user:e})},r.state={user:null},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{className:"App",children:Object(b.jsx)("div",{className:"container",children:Object(b.jsxs)(h.a,{basename:"",children:[Object(b.jsx)(v,{}),Object(b.jsxs)(j.c,{children:[Object(b.jsx)(j.a,{exact:!0,path:"/",render:function(e){return Object(b.jsx)(p,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/login",render:function(t){return Object(b.jsx)(U,Object(c.a)(Object(c.a)({},t),{},{state:e.state,setUser:e.setUser}))}}),Object(b.jsx)(j.a,{exact:!0,path:"/signup",render:function(e){return Object(b.jsx)(P,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/users/:id",render:function(e){return Object(b.jsx)(G,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/book/:id",render:function(e){return Object(b.jsx)(Z,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/write/:id",render:function(e){return Object(b.jsx)(ee,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/review/:id",render:function(e){return Object(b.jsx)(re,Object(c.a)({},e))}}),Object(b.jsx)(j.a,{exact:!0,path:"/settings",render:function(e){return Object(b.jsx)(ie,Object(c.a)({},e))}})]})]})})})}}]),n}(a.a.Component),oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),s(e),i(e)}))};i.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(ce,{})}),document.getElementById("root")),oe()}},[[39,1,2]]]);
//# sourceMappingURL=main.d0ebb8f9.chunk.js.map